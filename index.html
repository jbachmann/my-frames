<!DOCTYPE html>
<html>
  <head>
    <title>main</title>
  </head>
  <body>
    <iframe></iframe>

    <script>
      const trustedOrigins = ["http://localhost:5500"];

      const iframe = document.querySelector("iframe");
      iframe.addEventListener("load", () => {
        iframe.contentWindow.postMessage(
          JSON.stringify({ message: "this should be delivered to an iframe" })
        );
      });
      iframe.setAttribute("src", "iframe.html");

      function onMsg(msg) {
        if (!trustedOrigins.includes(msg.origin)) return;
        console.log(`Message from an iframe`, msg);
      }

      window.addEventListener("message", onMsg, false);
    </script>
  </body>
</html>
